We are given
Digest: 1da262b567ba1324b555f736c140000c72eb75aa08e439d12267b1f95c434efc
Message: 'UNLOCK_FLAG1'



Wikipedia describes the padding step as:
	Pre-processing (Padding):
	begin with the original message of length L bits
	append a single '1' bit
	append K '0' bits, where K is the minimum number >= 0 such that L + 1 + K + 64 is a multiple of 512
	append L as a 64-bit big-endian integer, making the total post-processed length a multiple of 512 bits

1. Add padding to the message to 

h = { 0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a, 0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19 }

00000000: ffff ffff ffff ffff ffff ffff ffff ffff  ................
00000010: 554e 4c4f 434b 5f46 4c41 4731 8000 0000  UNLOCK_FLAG1....
00000020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000030: 0000 0000 0000 0000 0000 0000 0000 00e0  ................

h = { 0x1da262b5, 0x67ba1324, 0xb555f736, 0xc140000c, 0x72eb75aa, 0x08e439d1, 0x2267b1f9, 0x5c434efc }

If we have the current state, then there's nothing stopping us from just appending another block
to get a new state

00000040: 0055 4e4c 4f43 4b5f 464c 4147 3280 0000  .UNLOCK_FLAG2...
00000050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000070: 0000 0000 0000 0000 0000 0000 0000 0268  ...............h

h = { 0x94e5cfb2, 0xe399e5f, 0xfbf26976, 0x3d2e761f, 0xf1c556bf, 0x3f3001d1, 0x25d7440c, 0x8dd218db }

Removing the padding and the key, our new message becomes

00000000: 554e 4c4f 434b 5f46 4c41 4731 8000 0000  UNLOCK_FLAG1....
00000010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000020: 0000 0000 0000 0000 0000 0000 0000 00e0  ................
00000030: 0055 4e4c 4f43 4b5f 464c 4147 32         .UNLOCK_FLAG2

and our MAC: 94e5cfb2e399e5ffbf269763d2e761ff1c556bf3f3001d125d7440c8dd218db

This message has an authentic MAC and instructs the driver:

'UNLOCK_FLAG1\x80' (Invalid command, silently ignored)
'' (Sent quite a few times, an invalid command so silently ignored)
'\xe0' (Invalid command, silently ignored)
'UNLOCK_FLAG2' (Valid command, the kernel driver allows access to flag2)
